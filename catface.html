<!DOCTYPE html>
<html>
  <head>
    <title>:3 :3 :3</title>
    <link rel='icon' type='image/png' href='favicon.png'>
  </head>
  <body>
    <button onclick='saveGame();'>OwO</button>
    <h1>:3 :3 :3</h1>
    <p id='numishere'>0</p>
    <button onclick='inc();'><3</button>
    <button onclick='incn(0,-1);'>:3</button>
    <script>
      let a=[[1n]];
      let y=0;
      function inc() {
        let newbutton=document.createElement('button');
        a.push([1n]);
        y++;
        let y2=y;
        newbutton.innerText=':D '.repeat(y)+':3';
        newbutton.onclick=(()=>incn(y2,-1));
        let newbr=document.createElement('br');
        newbr.id=y.toString();
        document.body.appendChild(newbr);
        document.body.appendChild(document.createElement('br'));
        document.body.appendChild(newbutton);
      }
      function incn(m,n) {
        if (m==0&&n==-1) {
          let numisthere=document.getElementById('numishere');
          numisthere.innerText=BigInt(numishere.innerText)+a[0][0];
        } else if (n==-1) {
          for(let i=0n;i<a[m][0];i++){
            let newbutton=document.createElement('button');
            newbutton.innerText=':D '.repeat(m-1)+':) '.repeat(a[m-1].length)+':3';
            let m2=m-1;
            let alen=a[m-1].length-1;
            newbutton.onclick=(()=>incn(m2,alen));
            a[m-1].push(1n);
            document.body.insertBefore(newbutton,document.getElementById(m.toString()));
          }
        } else {
          a[m][n]+=a[m][n+1];
        }
      }
      function saveGame() {
        let saveData = {
          a:a.map(arr => arr.map(b => b.toString())),
          y:y,
          number:document.getElementById('numishere').innerText.toString()
        };
        localStorage.setItem("catface",JSON.stringify(saveData));
        alert("Saved!");
      }
      function loadGame() {
        let raw=localStorage.getItem("catface");
        let saveData=JSON.parse(raw);
        a=saveData.a.map(arr => arr.map(s => BigInt(s)));
        y=saveData.y;
        document.getElementById('numishere').innerText=BigInt(saveData.number);
        for(let i=1;i<=y;i++) {
          let y2=i;
          let newbutton=document.createElement('button');
        newbutton.innerText=':D '.repeat(i)+':3';
        newbutton.onclick=(()=>incn(y2,-1));
        let newbr=document.createElement('br');
        newbr.id=i.toString();
        document.body.appendChild(newbr);
        document.body.appendChild(document.createElement('br'));
        document.body.appendChild(newbutton);
          for(let j=0;j<=a[i-1].length-2;j++) {
            let newbutton=document.createElement('button');
            newbutton.innerText=':D '.repeat(i-1)+':) '.repeat(j+1)+':3';
            let x=i-1;
            let y=j;
            newbutton.onclick=(()=>incn(x,y));
            document.body.insertBefore(newbutton,document.getElementById(i.toString()));
          }
        }
      }
      if (!localStorage.getItem("curSave")){saveGame();}
      loadGame();
    </script>
  </body>
</html>
