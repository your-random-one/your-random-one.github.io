<!DOCTYPE html>
<html>
  <head>
    <title>MinimaButtons</title>
    <script src='/socket.io/socket.io.js'></script>
  </head>
  <body>
    <h1>MinimaButtons</h1>
    <p id='numishere'>0</p>
    <button onclick='inc();'>Increment Layer</button>
    <button onclick='incn(0,-1);'>Increment</button>
    <script>
      let socket=io();
      let a=[[1n]];
      let y=0;
      function inc(send=true) {
	if(!send) {
        let newbutton=document.createElement('button');
        a.push([1n]);
        y++;
        let y2=y;
        newbutton.innerText='Increment'+' Incrementor'.repeat(y)+'s';
        newbutton.onclick=()=>socket.emit('buttonPressed',{data:[y2,-1]});
        let newbr=document.createElement('br');
        newbr.id=y.toString();
        document.body.appendChild(newbr);
        document.body.appendChild(document.createElement('br'));
        document.body.appendChild(newbutton);
	}
	if(send){
socket.emit('buttonPressed',{data:[-1,-1]});
}
      }
      function incn(m,n,send=true) {
	if(!send) {
        if (m==0&&n==-1) {
          let numisthere=document.getElementById('numishere');
          numisthere.innerText=BigInt(numishere.innerText)+a[0][0];
        } else if (n==-1) {
          for(let i=0n;i<a[m][0];i++){
            let newbutton=document.createElement('button');
            newbutton.innerText='Increment'+' Incrementor'.repeat(m-1)+' Incrementing'.repeat(a[m-1].length);
            let m2=m-1;
            let alen=a[m-1].length-1;
            newbutton.onclick=()=>socket.emit('buttonPressed',{data:[m2,alen]});
            a[m-1].push(1n);
            document.body.insertBefore(newbutton,document.getElementById(m.toString()));
          }
        } else {
          a[m][n]+=a[m][n+1];
        }
	}
	if(send) {
socket.emit('buttonPressed',{data:[m,n]});
}
      }
      socket.on('buttonPressed',({data})=>{
let [m,n]=data;
if (m==-1) {
inc(false);
} else {
incn(m,n,false);
}
});
    </script>
  </body>
</html>
